# Croupier Dashboard

[![License](https://img.shields.io/badge/license-Apache%202.0-blue.svg)](https://github.com/cuihairu/croupier/blob/main/LICENSE)

React + Umi Max + Ant Design Pro ç®¡ç†ç•Œé¢ï¼Œä¸º Croupier æ¸¸æˆå‡½æ•°å¹³å°æä¾›å¯è§†åŒ–ç®¡ç†åŠŸèƒ½ã€‚

> ğŸ¯ **æ ¸å¿ƒå®šä½**ï¼šå‡½æ•°ç®¡ç†ã€å®æ—¶ç›‘æ§ã€å®¡æ‰¹å·¥ä½œæµã€æ¸¸æˆæ•°æ®å¯è§†åŒ–ç®¡ç†ç•Œé¢
>
> ğŸ”— **ä¸»ä»“åº“**ï¼š[cuihairu/croupier](https://github.com/cuihairu/croupier)
>
> ğŸ“± **åœ¨çº¿æ¼”ç¤º**ï¼š[Dashboard Demo](https://demo.croupier.io) ï¼ˆå³å°†å¼€æ”¾ï¼‰

## Overview

Croupier Dashboard æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ React åº”ç”¨ï¼Œä¸ºæ¸¸æˆè¿è¥å›¢é˜Ÿæä¾›ç›´è§‚çš„å‡½æ•°ç®¡ç†å’Œæ¸¸æˆæ•°æ®ç›‘æ§å¹³å°ã€‚é€šè¿‡ä¸ Croupier Server çš„ REST API å¯¹æ¥ï¼Œå®ç°å‡½æ•°è°ƒç”¨ã€å®ä½“ç®¡ç†ã€å®¡æ‰¹æµç¨‹å’Œç³»ç»Ÿç›‘æ§ç­‰åŠŸèƒ½ã€‚

## Features

### ğŸš€ å‡½æ•°ç®¡ç†
- **ç‹¬ç«‹å‡½æ•°ç®¡ç†ç•Œé¢**ï¼šå…¨æ–°çš„ `/functions` æ¨¡å—ï¼Œæä¾›å®Œæ•´çš„å‡½æ•°ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **æ‰¹é‡æ“ä½œæ”¯æŒ**ï¼šæ‰¹é‡å¯ç”¨/ç¦ç”¨ã€å¤åˆ¶ã€åˆ é™¤å‡½æ•°
- **é«˜çº§æœç´¢è¿‡æ»¤**ï¼šæŒ‰å‡½æ•°IDã€åç§°ã€åˆ†ç±»ã€çŠ¶æ€å¿«é€Ÿç­›é€‰
- **å®æ—¶çŠ¶æ€ç›‘æ§**ï¼šå‡½æ•°å¥åº·çŠ¶æ€ã€Agentæ•°é‡ã€è°ƒç”¨ç»Ÿè®¡
- **å¯è§†åŒ–é…ç½®ç¼–è¾‘**ï¼šJSON Schemaç¼–è¾‘å™¨ã€UIé…ç½®å®æ—¶é¢„è§ˆ

### ğŸ“Š æ•°æ®å¯è§†åŒ–
- **å®æ—¶å¤§å±**ï¼šKPIæŒ‡æ ‡ã€ç•™å­˜åˆ†æã€æ”¯ä»˜æ•°æ®ã€ç”¨æˆ·è¡Œä¸º
- **è‡ªå®šä¹‰ä»ªè¡¨ç›˜**ï¼šæ”¯æŒæ‹–æ‹½å¸ƒå±€ã€ç»„ä»¶è‡ªå®šä¹‰
- **å¤šç»´åº¦åˆ†æ**ï¼šæ¸ é“æŠ•æ”¾ã€å…³å¡æ•°æ®ã€äººç¾¤åˆ†å±‚

### ğŸ” å®‰å…¨ä¸åˆè§„
- **RBACæƒé™æ§åˆ¶**ï¼šç»†ç²’åº¦çš„è§’è‰²æƒé™ç®¡ç†
- **åŒäººå®¡æ‰¹æµç¨‹**ï¼šé«˜é£é™©æ“ä½œéœ€è¦åŒäººå®¡æ‰¹
- **æ“ä½œå®¡è®¡æ—¥å¿—**ï¼šå®Œæ•´çš„æ“ä½œé“¾è·¯è¿½è¸ª
- **IPé£æ§æç¤º**ï¼šå¼‚åœ°ç™»å½•å‘Šè­¦ã€æ“ä½œé£é™©æç¤º

### ğŸ® æ¸¸æˆè¿è¥å·¥å…·
- **å®ä½“ç®¡ç†**ï¼šåŸºäºSchemaçš„CRUDï¼Œæ”¯æŒç™½åå•ã€é“å…·ã€ç¤¼åŒ…ç­‰
- **ç©å®¶ç®¡ç†**ï¼šç©å®¶ä¿¡æ¯æŸ¥è¯¢ã€ä½™é¢æ“ä½œã€å°ç¦è§£å°
- **ä»»åŠ¡ç›‘æ§**ï¼šå¼‚æ­¥ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€ã€æ—¥å¿—æµå¼å±•ç¤º

## Quick Start

### Prerequisites

- **Node.js**: 18+ (æ¨è 20/22)
- **Package Manager**: pnpm 9+ (æ”¯æŒ npm/yarn)

### Installation

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/cuihairu/croupier-dashboard.git
cd croupier-dashboard

# å®‰è£…ä¾èµ–
pnpm install
```

### Development

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# è®¿é—® http://localhost:8000
# é»˜è®¤è´¦å·ï¼šadmin / admin123
```

å¼€å‘æ¨¡å¼ç‰¹æ€§ï¼š
- ğŸ”¥ çƒ­æ›´æ–°æ”¯æŒ
- ğŸŒ APIä»£ç†ï¼š`/api` â†’ `http://localhost:8080`
- ğŸ› è°ƒè¯•å·¥å…·é›†æˆ
- ğŸ“Š Mockæ•°æ®æ”¯æŒ

### Production Build

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# è¾“å‡ºåˆ° dist/ ç›®å½•
# æ”¯æŒ CSPã€Gzipã€Tree Shaking
```

### Code Quality

```bash
# ESLint æ£€æŸ¥
pnpm lint

# TypeScript ç±»å‹æ£€æŸ¥
pnpm tsc

# ä»£ç æ ¼å¼åŒ–
pnpm format

# è¿è¡Œæµ‹è¯•
pnpm test
```

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚     â”‚                 â”‚     â”‚                 â”‚
â”‚  Web Browser    â”‚â—„â”€â”€â”€â”€â–ºâ”‚ Croupier Server â”‚â—„â”€â”€â”€â”€â–ºâ”‚   Game Servers  â”‚
â”‚                 â”‚ API â”‚                 â”‚ gRPC â”‚                 â”‚
â”‚   React SPA     â”‚     â”‚   REST/HTTP     â”‚     â”‚   SDK (Go/Java) â”‚
â”‚                 â”‚     â”‚   Dashboard     â”‚     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â–¼                        â–¼                        â–¼
   Frontend              Control Plane              Game Logic
 Dashboard              Functions Registry          SDK
 â”œâ”€ Functions           â”œâ”€ Functions List           â”œâ”€ Registration
 â”œâ”€ Analytics           â”œâ”€ Invocation               â”œâ”€ Handlers
 â”œâ”€ Games               â”œâ”€ Load Balancing           â”œâ”€ Descriptors
 â”œâ”€ Users               â”œâ”€ Job Queue                â””â”€ Health Checks
 â””â”€ Settings            â””â”€ Audit Logs
```

## API Integration

### Authentication Flow

```typescript
// ç™»å½•è·å– Token
POST /api/v1/auth/login
{
  "username": "admin",
  "password": "admin123"
}
// Response
{
  "token": "jwt_token_here",
  "user": {
    "id": "admin",
    "roles": ["admin"]
  }
}

// åç»­è¯·æ±‚æºå¸¦ Authorization Header
Authorization: Bearer jwt_token_here
```

### Key API Endpoints

| Module | Endpoint | Description |
|--------|----------|-------------|
| **Functions** | `GET /api/v1/functions` | è·å–å‡½æ•°åˆ—è¡¨ |
| | `POST /api/v1/functions/:id/invoke` | è°ƒç”¨å‡½æ•° |
| | `POST /api/v1/functions/batch-update` | æ‰¹é‡æ›´æ–°çŠ¶æ€ |
| | `GET /api/v1/functions/:id/ui` | è·å–UIé…ç½® |
| **Analytics** | `GET /api/v1/analytics/overview` | è·å–æ¦‚è§ˆæ•°æ® |
| | `GET /api/v1/analytics/realtime` | å®æ—¶æ•°æ® |
| **Jobs** | `GET /api/v1/jobs/:id` | ä»»åŠ¡çŠ¶æ€ |
| | `GET /api/v1/jobs/:id/stream` | ä»»åŠ¡æ—¥å¿—æµ(SSE) |
| **Users** | `GET /api/v1/users/current` | å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| | `PUT /api/v1/users/password` | ä¿®æ”¹å¯†ç  |

## Configuration

### Environment Variables

```bash
# .env.local
# API é…ç½®
CROUPIER_API_URL=http://localhost:8080
CROUPIER_WS_URL=ws://localhost:8080

# åŠŸèƒ½å¼€å…³
ENABLE_MOCK=false
ENABLE_ANALYTICS=true
ENABLE_NOTIFICATION=true

# ç¬¬ä¸‰æ–¹æœåŠ¡
SENTRY_DSN=https://your-sentry-dsn
GA_MEASUREMENT_ID=G-XXXXXXXXXX
```

### Proxy Configuration

å¼€å‘ç¯å¢ƒä»£ç†é…ç½®è§ `config/proxy.ts`ï¼š

```typescript
export default {
  dev: {
    '/api': {
      target: 'http://localhost:8080',
      changeOrigin: true,
      pathRewrite: { '^': '' },
    },
    '/ws': {
      target: 'ws://localhost:8080',
      ws: true,
    },
  },
}
```

## Development Guide

### Project Structure

```
src/
â”œâ”€â”€ components/        # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ JSONSchemaEditor/    # Schemaç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ UISchemaEditor/      # UIé…ç½®ç¼–è¾‘å™¨
â”‚   â””â”€â”€ ...
â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ Functions/     # å‡½æ•°ç®¡ç†ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ Analytics/      # æ•°æ®åˆ†æ
â”‚   â”œâ”€â”€ GameManagement/ # æ¸¸æˆç®¡ç†
â”‚   â””â”€â”€ ...
â”œâ”€â”€ services/          # APIæœåŠ¡
â”‚   â””â”€â”€ croupier/       # Croupier API
â”œâ”€â”€ hooks/             # è‡ªå®šä¹‰Hooks
â”‚   â””â”€â”€ useFunctionInvoke/    # å‡½æ•°è°ƒç”¨
â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â””â”€â”€ types/             # TypeScriptç±»å‹
```

### Adding New Pages

1. åœ¨ `src/pages/` åˆ›å»ºé¡µé¢ç»„ä»¶
2. æ›´æ–° `config/routes.ts` æ·»åŠ è·¯ç”±
3. æ·»åŠ å›½é™…åŒ–é…ç½® `src/locales/`
4. åˆ›å»ºæœåŠ¡å±‚ `src/services/`

### Custom Hooks

```typescript
// ç¤ºä¾‹ï¼šä½¿ç”¨å‡½æ•°è°ƒç”¨Hook
import { useFunctionInvoke } from '@/hooks/useFunctionInvoke';

const MyComponent = () => {
  const { invoke, loading, error } = useFunctionInvoke({
    onSuccess: (data) => console.log('Success:', data),
    onError: (err) => message.error(err.message),
  });

  const handleInvoke = async () => {
    await invoke('player.ban', { playerId: '123', reason: 'cheat' });
  };

  return <Button onClick={handleInvoke}>Ban Player</Button>;
};
```

## Deployment

### Docker Deployment

```dockerfile
# Dockerfile
FROM node:20-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

### Kubernetes Deployment

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: croupier-dashboard
spec:
  replicas: 3
  selector:
    matchLabels:
      app: croupier-dashboard
  template:
    spec:
      containers:
      - name: dashboard
        image: croupier/dashboard:latest
        ports:
        - containerPort: 80
        env:
        - name: CROUPIER_API_URL
          value: "http://croupier-server:8080"
```

### Production Checklist

- [ ] æ›´æ–°ç¯å¢ƒå˜é‡é…ç½®
- [ ] é…ç½®CDNåŠ é€Ÿé™æ€èµ„æº
- [ ] å¯ç”¨Gzipå‹ç¼©
- [ ] é…ç½®CSPç­–ç•¥
- [ ] è®¾ç½®é”™è¯¯ç›‘æ§ï¼ˆSentryï¼‰
- [ ] é…ç½®è®¿é—®æ—¥å¿—
- [ ] å¯ç”¨HTTPS
- [ ] é…ç½®ç¼“å­˜ç­–ç•¥

## Performance Optimization

### Bundle Analysis

```bash
# åˆ†ææ‰“åŒ…ä½“ç§¯
pnpm analyze

# å¯ç”¨gzipå‹ç¼©
pnpm build:gzip
```

### Best Practices

1. **è·¯ç”±æ‡’åŠ è½½**ï¼šä½¿ç”¨ `dynamic` å¯¼å…¥å‡å°‘é¦–å±åŠ è½½
2. **ç»„ä»¶ç¼“å­˜**ï¼šåˆç†ä½¿ç”¨ `React.memo`
3. **è™šæ‹Ÿæ»šåŠ¨**ï¼šå¤§æ•°æ®åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
4. **é˜²æŠ–èŠ‚æµ**ï¼šæœç´¢è¾“å…¥ç­‰åœºæ™¯ä½¿ç”¨é˜²æŠ–
5. **å›¾ç‰‡ä¼˜åŒ–**ï¼šä½¿ç”¨WebPæ ¼å¼ï¼Œé…ç½®æ‡’åŠ è½½

## Contributing

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

### Code Standards

- ä½¿ç”¨ TypeScript è¿›è¡Œç±»å‹å®‰å…¨å¼€å‘
- éµå¾ª ESLint å’Œ Prettier é…ç½®
- ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–æ–°åŠŸèƒ½
- æäº¤ä¿¡æ¯éµå¾ª [Conventional Commits](https://conventionalcommits.org/)

### Issue Reporting

æŠ¥å‘Š Bug æ—¶è¯·æä¾›ï¼š

- æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨ç‰ˆæœ¬
- é‡ç°æ­¥éª¤
- é¢„æœŸè¡Œä¸ºå’Œå®é™…è¡Œä¸º
- ç›¸å…³çš„æˆªå›¾æˆ–é”™è¯¯æ—¥å¿—

## License

æœ¬é¡¹ç›®é‡‡ç”¨ Apache License 2.0 è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](https://github.com/cuihairu/croupier/blob/main/LICENSE) æ–‡ä»¶ã€‚

## Support

- ğŸ“– [æ–‡æ¡£ä¸­å¿ƒ](https://docs.croupier.io)
- ğŸ’¬ [è®¨è®ºåŒº](https://github.com/cuihairu/croupier/discussions)
- ğŸ› [é—®é¢˜åé¦ˆ](https://github.com/cuihairu/croupier/issues)
- ğŸ“§ é‚®ç®±ï¼šsupport@croupier.io
